@page "/OperationalData";
@using CNCMachineAASDashboard.Shared.Models.OperationalSubmodel;
@using Microsoft.AspNetCore.SignalR.Client;

@using CNCMachineAASDashboard.Client.Shared.SubmodelComponent;
@*@using BaSyx.Models.Core.AssetAdministrationShell.Implementations;*@
@using System.Security.Cryptography;
@using System.Text.RegularExpressions;
@using System.Text;

@inject NavigationManager NavigationManager;



@* <SubmodelComponent _name="Operational Data" _submodel="@_submodel"></SubmodelComponent>*@



@code {
    private HubConnection? hubConnection;
    public bool IsConnected;

    public OperationalSubmodel? _submodel;

    public object? SignalRData;

    private List<object>? temperature { get; set; }



    protected override async Task OnInitializedAsync()

    {

        hubConnection = new HubConnectionBuilder().WithUrl(NavigationManager.ToAbsoluteUri("/dataSend")).Build();


        hubConnection.On<OperationalSubmodel>("OperationaldataSend", data =>
        {

            SignalRData = data;

            if (data != null)
            {

                _submodel = data;
                

            }

            StateHasChanged();
        });
        await hubConnection.StartAsync();

        IsConnected = hubConnection.State == HubConnectionState.Connected ? true : false;
        StateHasChanged();

    }
}
