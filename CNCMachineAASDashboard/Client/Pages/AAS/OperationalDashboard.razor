@page "/OperationalData";
@using Microsoft.AspNetCore.SignalR.Client;
@using CNCMachineAASDashboard.Shared.Models;
@using CNCMachineAASDashboard.Client.Shared.SubmodelComponent;
@*@using BaSyx.Models.Core.AssetAdministrationShell.Implementations;*@
@using System.Security.Cryptography;
@using System.Text.RegularExpressions;
@using System.Text;
@inject NavigationManager NavigationManager;



 <SubmodelComponent _name="Operational Data" _submodel="@submodel"></SubmodelComponent>



@code {
    private HubConnection? hubConnection;
    public bool IsConnected;

    public Submodel? submodel;

    public object? SignalRData;

    private List<object>? temperature { get; set; }



    protected override async Task OnInitializedAsync()

    {

        hubConnection = new HubConnectionBuilder().WithUrl(NavigationManager.ToAbsoluteUri("/dataSend")).Build();


        hubConnection.On<Submodel>("OperationaldataSend", data =>
        {

            SignalRData = data;

            if (data != null)
            {

                submodel = data;
                

            }

            StateHasChanged();
        });
        await hubConnection.StartAsync();

        IsConnected = hubConnection.State == HubConnectionState.Connected ? true : false;
        StateHasChanged();

    }
}
